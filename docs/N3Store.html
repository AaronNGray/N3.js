<!DOCTYPE html>

<html>
<head>
  <title>N3Store.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="N3Lexer.html">
                  N3Lexer.js
                </a>
              
                
                <a class="source" href="N3Parser.html">
                  N3Parser.js
                </a>
              
                
                <a class="source" href="N3Store.html">
                  N3Store.js
                </a>
              
                
                <a class="source" href="N3StreamParser.html">
                  N3StreamParser.js
                </a>
              
                
                <a class="source" href="N3StreamWriter.html">
                  N3StreamWriter.js
                </a>
              
                
                <a class="source" href="N3Util.html">
                  N3Util.js
                </a>
              
                
                <a class="source" href="N3Writer.html">
                  N3Writer.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>N3Store.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p><strong>N3Store</strong> objects store N3 triples by graph in memory.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> expandPrefixedName = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./N3Util'</span>).expandPrefixedName;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="constructor">Constructor</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">N3Store</span>(<span class="hljs-params">triples, options</span>) </span>{
  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> N3Store))
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> N3Store(triples, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>The number of triples is initially zero</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">this</span>._size = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p><code>_graphs</code> contains subject, predicate, and object indexes per graph</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">this</span>._graphs = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p><code>_ids</code> maps entities such as <code>http://xmlns.com/foaf/0.1/name</code> to numbers,
saving memory by using only numbers as keys in <code>_graphs</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">this</span>._id = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">this</span>._ids = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">this</span>._ids[<span class="hljs-string">'&gt;&lt;'</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// dummy entry, so the first actual key is non-zero</span>
  <span class="hljs-keyword">this</span>._entities = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>); <span class="hljs-comment">// inverse of `_ids`</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p><code>_blankNodeIndex</code> is the index of the last automatically named blank node</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">this</span>._blankNodeIndex = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Shift parameters if <code>triples</code> is not given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (!options &amp;&amp; triples &amp;&amp; !triples[<span class="hljs-number">0</span>])
    options = triples, triples = <span class="hljs-literal">null</span>;
  options = options || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Add triples and prefixes if passed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">this</span>._prefixes = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">if</span> (options.prefixes)
    <span class="hljs-keyword">this</span>.addPrefixes(options.prefixes);
  <span class="hljs-keyword">if</span> (triples)
    <span class="hljs-keyword">this</span>.addTriples(triples);
}

N3Store.prototype = {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="public-properties">Public properties</h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h3 id="-size-returns-the-number-of-triples-in-the-store"><code>size</code> returns the number of triples in the store</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  get size() {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Return the triple count if if was cached</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> size = <span class="hljs-keyword">this</span>._size;
    <span class="hljs-keyword">if</span> (size !== <span class="hljs-literal">null</span>)
      <span class="hljs-keyword">return</span> size;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Calculate the number of triples by counting to the deepest level</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> graphs = <span class="hljs-keyword">this</span>._graphs, subjects, subject;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> graphKey <span class="hljs-keyword">in</span> graphs)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> subjectKey <span class="hljs-keyword">in</span> (subjects = graphs[graphKey].subjects))
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> predicateKey <span class="hljs-keyword">in</span> (subject = subjects[subjectKey]))
          size += <span class="hljs-built_in">Object</span>.keys(subject[predicateKey]).length;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._size = size;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2 id="private-methods">Private methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h3 id="-_addtoindex-adds-a-triple-to-a-three-layered-index-"><code>_addToIndex</code> adds a triple to a three-layered index.</h3>
<p>Returns if the index has changed, if the entry did not already exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _addToIndex: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index0, key0, key1, key2</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Create layers as necessary</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> index1 = index0[key0] || (index0[key0] = {});
    <span class="hljs-keyword">var</span> index2 = index1[key1] || (index1[key1] = {});</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Setting the key to <em>any</em> value signals the presence of the triple</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> existed = key2 <span class="hljs-keyword">in</span> index2;
    <span class="hljs-keyword">if</span> (!existed)
      index2[key2] = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> !existed;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h3 id="-_removefromindex-removes-a-triple-from-a-three-layered-index"><code>_removeFromIndex</code> removes a triple from a three-layered index</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _removeFromIndex: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index0, key0, key1, key2</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Remove the triple from the index</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> index1 = index0[key0], index2 = index1[key1], key;
    <span class="hljs-keyword">delete</span> index2[key2];</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Remove intermediary index layers if they are empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> index2) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">delete</span> index1[key1];
    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> index1) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">delete</span> index0[key0];
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h3 id="-_findinindex-finds-a-set-of-triples-in-a-three-layered-index-"><code>_findInIndex</code> finds a set of triples in a three-layered index.</h3>
<p>The index base is <code>index0</code> and the keys at each level are <code>key0</code>, <code>key1</code>, and <code>key2</code>.
Any of these keys can be undefined, which is interpreted as a wildcard.
<code>name0</code>, <code>name1</code>, and <code>name2</code> are the names of the keys at each level,
used when reconstructing the resulting triple
(for instance: <em>subject</em>, <em>predicate</em>, and <em>object</em>).
Finally, <code>graph</code> will be the graph of the created triples.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _findInIndex: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index0, key0, key1, key2, name0, name1, name2, graph</span>) </span>{
    <span class="hljs-keyword">var</span> results = [], tmp, index1, index2, varCount = !key0 + !key1 + !key2,</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>depending on the number of variables, keys or reverse index are faster</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        entityKeys = varCount &gt; <span class="hljs-number">1</span> ? <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._ids) : <span class="hljs-keyword">this</span>._entities;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>If a key is specified, use only that part of index 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (key0) (tmp = index0, index0 = {})[key0] = tmp[key0];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value0 <span class="hljs-keyword">in</span> index0) {
      <span class="hljs-keyword">var</span> entity0 = entityKeys[value0];

      <span class="hljs-keyword">if</span> (index1 = index0[value0]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If a key is specified, use only that part of index 1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (key1) (tmp = index1, index1 = {})[key1] = tmp[key1];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value1 <span class="hljs-keyword">in</span> index1) {
          <span class="hljs-keyword">var</span> entity1 = entityKeys[value1];

          <span class="hljs-keyword">if</span> (index2 = index1[value1]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>If a key is specified, use only that part of index 2, if it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> values = key2 ? (key2 <span class="hljs-keyword">in</span> index2 ? [key2] : []) : <span class="hljs-built_in">Object</span>.keys(index2);</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Create triples for all items found in index 2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> l = values.length - <span class="hljs-number">1</span>; l &gt;= <span class="hljs-number">0</span>; l--) {
              <span class="hljs-keyword">var</span> result = { <span class="hljs-attr">subject</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">predicate</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">object</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">graph</span>: graph };
              result[name0] = entity0;
              result[name1] = entity1;
              result[name2] = entityKeys[values[l]];
              results.push(result);
            }
          }
        }
      }
    }
    <span class="hljs-keyword">return</span> results;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h3 id="-_countinindex-counts-matching-triples-in-a-three-layered-index-"><code>_countInIndex</code> counts matching triples in a three-layered index.</h3>
<p>The index base is <code>index0</code> and the keys at each level are <code>key0</code>, <code>key1</code>, and <code>key2</code>.
Any of these keys can be undefined, which is interpreted as a wildcard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _countInIndex: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index0, key0, key1, key2</span>) </span>{
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>, tmp, index1, index2;</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>If a key is specified, count only that part of index 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (key0) (tmp = index0, index0 = {})[key0] = tmp[key0];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value0 <span class="hljs-keyword">in</span> index0) {
      <span class="hljs-keyword">if</span> (index1 = index0[value0]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>If a key is specified, count only that part of index 1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (key1) (tmp = index1, index1 = {})[key1] = tmp[key1];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value1 <span class="hljs-keyword">in</span> index1) {
          <span class="hljs-keyword">if</span> (index2 = index1[value1]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>If a key is specified, count the triple if it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (key2) (key2 <span class="hljs-keyword">in</span> index2) &amp;&amp; count++;</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Otherwise, count all triples</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">else</span> count += <span class="hljs-built_in">Object</span>.keys(index2).length;
          }
        }
      }
    }
    <span class="hljs-keyword">return</span> count;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="public-methods">Public methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h3 id="-addtriple-adds-a-new-n3-triple-to-the-store-"><code>addTriple</code> adds a new N3 triple to the store.</h3>
<p>Returns if the triple index has changed, if the triple did not already exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  addTriple: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Shift arguments if a triple object is given instead of components</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!predicate)
      graph = subject.graph, object = subject.object,
        predicate = subject.predicate, subject = subject.subject;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Find the graph that will contain the triple</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    graph = graph || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> graphItem = <span class="hljs-keyword">this</span>._graphs[graph];</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Create the graph if it doesn’t exist yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!graphItem) {
      graphItem = <span class="hljs-keyword">this</span>._graphs[graph] = { <span class="hljs-attr">subjects</span>: {}, <span class="hljs-attr">predicates</span>: {}, <span class="hljs-attr">objects</span>: {} };</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Freezing a graph helps subsequent <code>add</code> performance,
and properties will never be modified anyway</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-built_in">Object</span>.freeze(graphItem);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Since entities can often be long IRIs, we avoid storing them in every index.
Instead, we have a separate index that maps entities to numbers,
which are then used as keys in the other indexes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> ids = <span class="hljs-keyword">this</span>._ids;
    <span class="hljs-keyword">var</span> entities = <span class="hljs-keyword">this</span>._entities;
    subject   = ids[subject]   || (ids[entities[++<span class="hljs-keyword">this</span>._id] = subject]   = <span class="hljs-keyword">this</span>._id);
    predicate = ids[predicate] || (ids[entities[++<span class="hljs-keyword">this</span>._id] = predicate] = <span class="hljs-keyword">this</span>._id);
    object    = ids[object]    || (ids[entities[++<span class="hljs-keyword">this</span>._id] = object]    = <span class="hljs-keyword">this</span>._id);

    <span class="hljs-keyword">var</span> changed = <span class="hljs-keyword">this</span>._addToIndex(graphItem.subjects,   subject,   predicate, object);
    <span class="hljs-keyword">this</span>._addToIndex(graphItem.predicates, predicate, object,    subject);
    <span class="hljs-keyword">this</span>._addToIndex(graphItem.objects,    object,    subject,   predicate);</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>The cached triple count is now invalid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>._size = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> changed;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h3 id="-addtriples-adds-multiple-n3-triples-to-the-store"><code>addTriples</code> adds multiple N3 triples to the store</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  addTriples: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">triples</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = triples.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)
      <span class="hljs-keyword">this</span>.addTriple(triples[i]);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <h3 id="-addprefix-adds-support-for-querying-with-the-given-prefix"><code>addPrefix</code> adds support for querying with the given prefix</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  addPrefix: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prefix, iri</span>) </span>{
    <span class="hljs-keyword">this</span>._prefixes[prefix] = iri;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <h3 id="-addprefixes-adds-support-for-querying-with-the-given-prefixes"><code>addPrefixes</code> adds support for querying with the given prefixes</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  addPrefixes: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prefixes</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prefix <span class="hljs-keyword">in</span> prefixes)
      <span class="hljs-keyword">this</span>.addPrefix(prefix, prefixes[prefix]);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <h3 id="-removetriple-removes-an-n3-triple-from-the-store-if-it-exists"><code>removeTriple</code> removes an N3 triple from the store if it exists</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  removeTriple: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Shift arguments if a triple object is given instead of components</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!predicate)
      graph = subject.graph, object = subject.object,
        predicate = subject.predicate, subject = subject.subject;
    graph = graph || <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Find internal identifiers for all components</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> graphItem, ids = <span class="hljs-keyword">this</span>._ids, graphs = <span class="hljs-keyword">this</span>._graphs;
    <span class="hljs-keyword">if</span> (!(subject   = ids[subject]))   <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(predicate = ids[predicate])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(object    = ids[object]))    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(graphItem = graphs[graph]))  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Verify that the triple exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> subjects, predicates;
    <span class="hljs-keyword">if</span> (!(subjects   = graphItem.subjects[subject])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(predicates = subjects[predicate])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(object <span class="hljs-keyword">in</span> predicates)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Remove it from all indexes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>._removeFromIndex(graphItem.subjects,   subject,   predicate, object);
    <span class="hljs-keyword">this</span>._removeFromIndex(graphItem.predicates, predicate, object,    subject);
    <span class="hljs-keyword">this</span>._removeFromIndex(graphItem.objects,    object,    subject,   predicate);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._size !== <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>._size--;</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Remove the graph if it is empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (subject <span class="hljs-keyword">in</span> graphItem.subjects) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">delete</span> graphs[graph];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <h3 id="-removetriples-removes-multiple-n3-triples-from-the-store"><code>removeTriples</code> removes multiple N3 triples from the store</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  removeTriples: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">triples</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = triples.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)
      <span class="hljs-keyword">this</span>.removeTriple(triples[i]);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <h3 id="-find-finds-a-set-of-triples-matching-a-pattern-expanding-prefixes-as-necessary-"><code>find</code> finds a set of triples matching a pattern, expanding prefixes as necessary.</h3>
<p>Setting any field to <code>undefined</code> or <code>null</code> indicates a wildcard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  find: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{
    <span class="hljs-keyword">var</span> prefixes = <span class="hljs-keyword">this</span>._prefixes;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByIRI(
      expandPrefixedName(subject,   prefixes),
      expandPrefixedName(predicate, prefixes),
      expandPrefixedName(object,    prefixes),
      expandPrefixedName(graph,     prefixes)
    );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <h3 id="-findbyiri-finds-a-set-of-triples-matching-a-pattern-"><code>findByIRI</code> finds a set of triples matching a pattern.</h3>
<p>Setting any field to <code>undefined</code> or <code>null</code> indicates a wildcard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  findByIRI: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{
    <span class="hljs-keyword">var</span> quads = [], graphs = {}, graphContents,
        ids = <span class="hljs-keyword">this</span>._ids, subjectId, predicateId, objectId;</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Either loop over all graphs, or over just one selected graph</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!isString(graph))
      graphs = <span class="hljs-keyword">this</span>._graphs;
    <span class="hljs-keyword">else</span>
      graphs[graph] = <span class="hljs-keyword">this</span>._graphs[graph];</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Translate IRIs to internal index keys.
Optimization: if the entity doesn’t exist, no triples with it exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (isString(subject)   &amp;&amp; !(subjectId   = ids[subject]))   <span class="hljs-keyword">return</span> quads;
    <span class="hljs-keyword">if</span> (isString(predicate) &amp;&amp; !(predicateId = ids[predicate])) <span class="hljs-keyword">return</span> quads;
    <span class="hljs-keyword">if</span> (isString(object)    &amp;&amp; !(objectId    = ids[object]))    <span class="hljs-keyword">return</span> quads;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> graphId <span class="hljs-keyword">in</span> graphs) {</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Only if the specified graph contains triples, there can be results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (graphContents = graphs[graphId]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Choose the optimal index, based on what fields are present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (subjectId) {
          <span class="hljs-keyword">if</span> (objectId)</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>If subject and object are given, the object index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            quads.push(<span class="hljs-keyword">this</span>._findInIndex(graphContents.objects, objectId, subjectId, predicateId,
                                         <span class="hljs-string">'object'</span>, <span class="hljs-string">'subject'</span>, <span class="hljs-string">'predicate'</span>, graphId));
          <span class="hljs-keyword">else</span></pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>If only subject and possibly predicate are given, the subject index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            quads.push(<span class="hljs-keyword">this</span>._findInIndex(graphContents.subjects, subjectId, predicateId, <span class="hljs-literal">null</span>,
                                         <span class="hljs-string">'subject'</span>, <span class="hljs-string">'predicate'</span>, <span class="hljs-string">'object'</span>, graphId));
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (predicateId)</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>If only predicate and possibly object are given, the predicate index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          quads.push(<span class="hljs-keyword">this</span>._findInIndex(graphContents.predicates, predicateId, objectId, <span class="hljs-literal">null</span>,
                                       <span class="hljs-string">'predicate'</span>, <span class="hljs-string">'object'</span>, <span class="hljs-string">'subject'</span>, graphId));
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (objectId)</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>If only object is given, the object index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          quads.push(<span class="hljs-keyword">this</span>._findInIndex(graphContents.objects, objectId, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>,
                                       <span class="hljs-string">'object'</span>, <span class="hljs-string">'subject'</span>, <span class="hljs-string">'predicate'</span>, graphId));
        <span class="hljs-keyword">else</span></pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>If nothing is given, iterate subjects and predicates first</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          quads.push(<span class="hljs-keyword">this</span>._findInIndex(graphContents.subjects, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>,
                                       <span class="hljs-string">'subject'</span>, <span class="hljs-string">'predicate'</span>, <span class="hljs-string">'object'</span>, graphId));
      }
    }
    <span class="hljs-keyword">return</span> quads.length === <span class="hljs-number">1</span> ? quads[<span class="hljs-number">0</span>] : quads.concat.apply([], quads);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <h3 id="-count-returns-the-number-of-triples-matching-a-pattern-expanding-prefixes-as-necessary-"><code>count</code> returns the number of triples matching a pattern, expanding prefixes as necessary.</h3>
<p>Setting any field to <code>undefined</code> or <code>null</code> indicates a wildcard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  count: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{
    <span class="hljs-keyword">var</span> prefixes = <span class="hljs-keyword">this</span>._prefixes;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.countByIRI(
      expandPrefixedName(subject,   prefixes),
      expandPrefixedName(predicate, prefixes),
      expandPrefixedName(object,    prefixes),
      expandPrefixedName(graph,     prefixes)
    );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <h3 id="-countbyiri-returns-the-number-of-triples-matching-a-pattern-"><code>countByIRI</code> returns the number of triples matching a pattern.</h3>
<p>Setting any field to <code>undefined</code> or <code>null</code> indicates a wildcard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  countByIRI: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">subject, predicate, object, graph</span>) </span>{
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>, graphs = {}, graphContents,
        ids = <span class="hljs-keyword">this</span>._ids, subjectId, predicateId, objectId;</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Either loop over all graphs, or over just one selected graph</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!isString(graph))
      graphs = <span class="hljs-keyword">this</span>._graphs;
    <span class="hljs-keyword">else</span>
      graphs[graph] = <span class="hljs-keyword">this</span>._graphs[graph];</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Translate IRIs to internal index keys.
Optimization: if the entity doesn’t exist, no triples with it exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (isString(subject)   &amp;&amp; !(subjectId   = ids[subject]))   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (isString(predicate) &amp;&amp; !(predicateId = ids[predicate])) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (isString(object)    &amp;&amp; !(objectId    = ids[object]))    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> graphId <span class="hljs-keyword">in</span> graphs) {</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Only if the specified graph contains triples, there can be results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (graphContents = graphs[graphId]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Choose the optimal index, based on what fields are present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (subject) {
          <span class="hljs-keyword">if</span> (object)</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>If subject and object are given, the object index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            count += <span class="hljs-keyword">this</span>._countInIndex(graphContents.objects, objectId, subjectId, predicateId);
          <span class="hljs-keyword">else</span></pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>If only subject and possibly predicate are given, the subject index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            count += <span class="hljs-keyword">this</span>._countInIndex(graphContents.subjects, subjectId, predicateId, objectId);
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (predicate) {</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>If only predicate and possibly object are given, the predicate index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          count += <span class="hljs-keyword">this</span>._countInIndex(graphContents.predicates, predicateId, objectId, subjectId);
        }
        <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>If only object is possibly given, the object index will be the fastest</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          count += <span class="hljs-keyword">this</span>._countInIndex(graphContents.objects, objectId, subjectId, predicateId);
        }
      }
    }
    <span class="hljs-keyword">return</span> count;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <h3 id="-createblanknode-creates-a-new-blank-node-returning-its-name"><code>createBlankNode</code> creates a new blank node, returning its name</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  createBlankNode: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">suggestedName</span>) </span>{
    <span class="hljs-keyword">var</span> name, index;</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Generate a name based on the suggested name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (suggestedName) {
      name = suggestedName = <span class="hljs-string">'_:'</span> + suggestedName, index = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>._ids[name])
        name = suggestedName + index++;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Generate a generic blank node name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">do</span> { name = <span class="hljs-string">'_:b'</span> + <span class="hljs-keyword">this</span>._blankNodeIndex++; }
      <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>._ids[name]);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Add the blank node to the entities, avoiding the generation of duplicates</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>._ids[name] = ++<span class="hljs-keyword">this</span>._id;
    <span class="hljs-keyword">this</span>._entities[<span class="hljs-keyword">this</span>._id] = name;
    <span class="hljs-keyword">return</span> name;
  },
};</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Determines whether the argument is a string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isString</span>(<span class="hljs-params">s</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> s === <span class="hljs-string">'string'</span> || s <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">String</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <h2 id="exports">Exports</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">module</span>.exports = N3Store;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
